# redis数据持久化方案及优缺点

redis持久化方案：

- RDB：在指定时间间隔内生成数据集的时间点快照；
- AOF：持久化记录服务器执行的所有命令操作，通过重新执行这些命令来恢复数据；

> redis支持同时使用RDB和AOF方式进行持久化



RDB优点：

- 只有一个文件，文件紧凑，可在加密后发送发到数据中心如S3中存储；
- 性能好，父进程 fork 出一个子进程，然后子进程就会处理所有保存工作，父进程无须执行磁盘 *I/O* 操作；
- 恢复大数据集时比AOF块；

RDB缺点：

- 不能百分百保证数据不丢失；
- 数据量大时，消耗的资源较多，可能导致服务端某个时刻无法响应请求；



AOF优点：

- AOF默认策略1秒钟记录一次，这样可以保证良好的性能，最多损失一秒的数据；
- AOF文件是一个只追加的日志文件，这样如果因为磁盘满了或其他原因导致文件有未写入的命令，redis-check-aof 工具也可以轻易地修复这种问题；
- redis可在AOF文件过大时自动重写，这个操作时绝对安全的；
- AOF文件易读，如果有误操作可以在文件中删除误操作命令就可以恢复数据；

AOF缺点：

- 相同数据集下，AOF体积通常大于RDB体积；
- AOF速度可能慢于RDB；



# Mysql索引的优缺点及注意事项

优点：

- 使用索引可以减少扫描的数据量，加快查找效率；
- 唯一索引保证数据唯一性；
- 索引可以将随机I/O变为顺序I/O；
- 利用索引对数据存储的特性，可以使查询语句避免排序和创建临时表；

缺点：

- 索引创建和维护增大了工作量；
- 索引增加了数据量，占用了空间；
- 不恰当的索引会重复扫描数据，浪费查询；

注意事项：

- 数据量非常小，全表扫描会比索引更高效；
- 中型表使用索引非常有效，查询条件需要与索引配合使用才能有效利用索引；
- 大型表建立和使用索引代价较高，应优先考虑对数据进行分组优化；